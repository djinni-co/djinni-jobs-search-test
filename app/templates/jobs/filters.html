<div class="mb-4">
    <form method="GET">
        <div class="row">
            <div class="col-sm-6">
                <input type="search" name="search" value="{{ request.GET.search }}" class="form-control mb-2"
                    placeholder="Search jobs">
            </div>
            <div class="col-auto">
                <button type="submit" class="btn btn-primary">Search</button>
            </div>
        </div>

        <div class="row align-items-center mb-3">
            <div class="col-auto">
                <strong>{{ jobs.paginator.count }}</strong> jobs found.
            </div>
            <div class="col-auto d-flex align-items-center">
                <label for="sort" class="form-label mb-0 me-2">Sort by:</label>
                <select name="sort" id="sort" class="form-select form-select-sm" style="width: auto;"
                    onchange="this.form.submit()">
                    <option value="date_desc">Date Published (Most Recent)</option>
                    <option value="date_asc">Date Published (Oldest First)</option>
                    <option value="views_desc">Most Views</option>
                    <option value="views_asc">Least Views</option>
                </select>
            </div>
        </div>

        <!-- Filters Toggle Button -->
        <div class="mb-3">
            <button id="toggleFiltersBtn" class="btn btn-secondary" type="button">
                Show Filters
            </button>
        </div>

        <!-- Filters Container -->
        <div id="filtersContainer" style="display: none;">
            <div class="row">
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="keyword_search" class="form-label">Search by Keywords</label>
                        <input type="text" name="keyword_search" value="{{ request.GET.keyword_search }}"
                            class="form-control" placeholder="Search by Keywords">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="exclude_keywords" class="form-label">Exclude Words</label>
                        <input type="text" name="exclude_keywords" value="{{ request.GET.exclude_keywords }}"
                            class="form-control" placeholder="Exclude Words">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="remote_type" class="form-label">Type of Work</label>
                        <select name="remote_type" class="form-control">
                            <option value="">Any</option>
                            {% for choice in filter.form.remote_type.field.choices %}
                            {% if choice.0 == request.GET.remote_type %}
                            <option value="{{ choice.0 }}" selected>{{ choice.1 }}</option>
                            {% else %}
                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                            {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="country" class="form-label">Country</label>
                        <input type="text" name="country" value="{{ request.GET.country }}" class="form-control"
                            placeholder="Country (ISO 3166-1 alpha-3)">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="location" class="form-label">City</label>
                        <input type="text" name="location" value="{{ request.GET.location }}" class="form-control"
                            placeholder="City">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="english_level" class="form-label">English</label>
                        <select name="english_level" class="form-control">
                            <option value="">Any</option>
                            {% for choice in filter.form.english_level.field.choices %}
                            {% if choice.0 == request.GET.english_level %}
                            <option value="{{ choice.0 }}" selected>{{ choice.1 }}</option>
                            {% else %}
                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                            {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="experience_years" class="form-label">Years of Experience</label>
                        <input type="number" name="experience_years" value="{{ request.GET.experience_years }}"
                            class="form-control" placeholder="Years of Experience">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="company_name" class="form-label">Company Name</label>
                        <input type="text" name="company_name" value="{{ request.GET.company_name }}"
                            class="form-control" placeholder="Company Name">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="salaryRange" class="form-label">Salary Range (Max)</label>
                        <div class="range-value">
                            <span id="rangeMin">0</span>
                            <span id="rangeMax">{{ max_salary }}</span>
                        </div>
                        <input type="range" class="form-range" min="0" max="{{ max_salary }}" step="1000"
                            name="salary_max" value="{{ request.GET.salary_max|default:max_salary }}" id="salaryRange">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="domain" class="form-label">Domain</label>
                        <select name="domain" class="form-control">
                            <option value="">Any</option>
                            {% for choice in filter.form.domain.field.choices %}
                            {% if choice.0 == request.GET.domain %}
                            <option value="{{ choice.0 }}" selected>{{ choice.1 }}</option>
                            {% else %}
                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                            {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="filter-section">
                        <label for="company_type" class="form-label">Company Type</label>
                        <select name="company_type" class="form-control">
                            <option value="">Any</option>
                            {% for choice in filter.form.company_type.field.choices %}
                            {% if choice.0 == request.GET.company_type %}
                            <option value="{{ choice.0 }}" selected>{{ choice.1 }}</option>
                            {% else %}
                            <option value="{{ choice.0 }}">{{ choice.1 }}</option>
                            {% endif %}
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            <!-- Filters and Clear Filters in a New Line -->
            <div class="row mt-3">
                <div class="col-md-4">
                    <button type="submit" class="btn btn-primary">Filter</button>
                    <a href="{% url 'jobs_list' %}" class="btn btn-danger">Clear Filters</a>
                </div>
            </div>
        </div>
    </form>
</div>